{
    "name": "SNMP Lab Environment",
    "build": {
        "dockerfile": "Dockerfile"
    },
    "features": {
        "ghcr.io/devcontainers/features/common-utils:2": {
            "installZsh": true,
            "configureZshAsDefaultShell": true,
            "username": "vscode",
            "upgradePackages": true
        }
    },
    // Add required capabilities and devices
    "runArgs": [
        "--cap-add=SYS_ADMIN",
        "--cap-add=NET_ADMIN",
        "--privileged"
    ],
    // Forward SNMP ports
    "forwardPorts": [
        161,
        162
    ],
    // Configure environment variables
    "remoteEnv": {
        "MIBS": "ALL",
        "MIBDIRS": "/usr/share/snmp/mibs:/home/vscode/gp2/mibs"
    },
    // Install VS Code extensions
    "customizations": {
        "vscode": {
            "extensions": [
                "hashicorp.terraform",
                "ms-azuretools.vscode-docker",
                "ms-vscode-remote.remote-containers"
            ]
        }
    },
    // Mount lab files
    "mounts": [
        "source=${localWorkspaceFolder}/gp2,target=/home/vscode/gp2,type=bind,consistency=cached"
    ],
    // Configure default settings
    "settings": {
        "terminal.integrated.defaultProfile.linux": "zsh",
        "terminal.integrated.profiles.linux": {
            "zsh": {
                "path": "/usr/bin/zsh"
            }
        }
    },
    // Post-create commands
    "postCreateCommand": "sudo chmod +x /home/vscode/gp2/*.sh && sudo apt-get update && sudo apt-get install -y snmp snmpd snmp-mibs-downloader",
    // Lifecycle scripts
    "initializeCommand": {
        "pre-build": "mkdir -p ${localWorkspaceFolder}/gp2/mibs"
    }
}
